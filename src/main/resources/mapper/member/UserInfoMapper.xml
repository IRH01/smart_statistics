<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hhly.smartdata.mapper.member.UserInfoMapper">
    <resultMap id="BaseResultMap" type="com.hhly.smartdata.model.member.UserInfo">
        <id column="user_id" property="userId" jdbcType="VARCHAR"/>
        <result column="password" property="password" jdbcType="VARCHAR"/>
        <result column="email" property="email" jdbcType="VARCHAR"/>
        <result column="phone" property="phone" jdbcType="VARCHAR"/>
        <result column="head_icon" property="headIcon" jdbcType="VARCHAR"/>
        <result column="nickname" property="nickname" jdbcType="VARCHAR"/>
        <result column="sex" property="sex" jdbcType="INTEGER"/>
        <result column="age" property="age" jdbcType="INTEGER"/>
        <result column="location" property="location" jdbcType="VARCHAR"/>
        <result column="status" property="status" jdbcType="INTEGER"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="last_login_time" property="lastLoginTime" jdbcType="TIMESTAMP"/>
        <result column="real_name" property="realName" jdbcType="VARCHAR"/>
        <result column="id_card_no" property="idCardNo" jdbcType="VARCHAR"/>
        <result column="address" property="address" jdbcType="VARCHAR"/>
        <result column="qq_number" property="qqNumber" jdbcType="VARCHAR"/>
        <result column="phone_status" property="phoneStatus" jdbcType="INTEGER"/>
        <result column="email_status" property="emailStatus" jdbcType="INTEGER"/>
        <result column="platform_id" property="platformId" jdbcType="INTEGER"/>
        <result column="reg_type" property="regType" jdbcType="INTEGER"/>
        <result column="paypassword" property="paypassword" jdbcType="VARCHAR"/>
        <result column="os_type" property="osType" jdbcType="INTEGER"/>
        <result column="version_code" property="versionCode" jdbcType="INTEGER"/>
        <result column="version_name" property="versionName" jdbcType="VARCHAR"/>
        <result column="head_icon_small" property="headIconSmall" jdbcType="VARCHAR"/>
        <result column="login_type" property="loginType" jdbcType="VARCHAR"/>
        <result column="is_adult" property="isAdult" jdbcType="VARCHAR"/>
        <result column="forbidden_starttime" property="forbiddenStarttime" jdbcType="TIMESTAMP"/>
        <result column="forbidden_enttime" property="forbiddenEnttime" jdbcType="TIMESTAMP"/>
        <result column="country" property="country" jdbcType="INTEGER"/>
        <result column="last_login_ip" property="lastLoginIp" jdbcType="VARCHAR"/>
        <result column="register_ip" property="registerIp" jdbcType="VARCHAR"/>
        <result column="forbidden_remak" property="forbiddenRemak" jdbcType="VARCHAR"/>
        <result column="invite_code" property="inviteCode" jdbcType="VARCHAR"/>
        <result column="channelid" property="channelid" jdbcType="VARCHAR"/>
    </resultMap>
    <sql id="Base_Column_List">
        user_id, password, email, phone, head_icon, nickname, sex, age, location, status,
        create_time, last_login_time, real_name, id_card_no, address, qq_number, phone_status,
        email_status, platform_id, reg_type, paypassword, os_type, version_code, version_name,
        head_icon_small, login_type, is_adult, forbidden_starttime, forbidden_enttime, country,
        last_login_ip, register_ip, forbidden_remak, invite_code, channelid
    </sql>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String">
        select
        <include refid="Base_Column_List"/>
        from tbl_user_info
        where user_id = #{userId,jdbcType=VARCHAR}
    </select>

    <select id="findUserInfoByTime" resultType="java.lang.Integer"
            parameterType="com.hhly.smartdata.model.member.UserInfo">
        select count(user_id) from tbl_user_info
        where country = 0
        <![CDATA[
             and create_time> date_sub(DATE_FORMAT(now(),'%Y-%m-%d %H:%i:%S'), interval 30 minute)
  	    ]]>
        <![CDATA[
             and create_time<=DATE_FORMAT(now(),'%Y-%m-%d %H:%i:%S')
  	    ]]>
    </select>

    <select id="selectOldRegisterUser" resultType="java.lang.String">
        SELECT
        user_id as UserId
        FROM
        tbl_user_info
        WHERE TO_DAYS(NOW()) - TO_DAYS(create_time) &gt; 1
    </select>

    <select id="selectBeforeHowManyDayRegisterUser" resultType="java.lang.String">
        SELECT
        user_id as UserId
        FROM
        tbl_user_info
        WHERE TO_DAYS(NOW()) - TO_DAYS(create_time) &lt;= #{days}
        AND TO_DAYS(NOW()) - TO_DAYS(create_time) &gt;= (#{days} - 1)
    </select>
</mapper>