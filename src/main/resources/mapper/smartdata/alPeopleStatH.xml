<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="alPeopleStatH">
	<resultMap type="AlPeopleStatH" id="AlPeopleStatHMap" extends="alPeopleStat.AlPeopleStatMap">
	</resultMap>
	
	<select id="find" resultMap="AlPeopleStatHMap" parameterType="map">
		select 
			etl_date,
			pv_cnt,
			uv_cnt,
			stay_cnt
		from tbl_dm_alpeople_stat_h
		where 1=1
			<if test="domainId != null">and domain_id = #{domainId}</if>
			<if test="channelId != null">and channel_id = #{channelId}</if>
			<if test="gameId != null">and game_id = #{gameId}</if>
			<if test="date != null">and date_format(etl_date,'%Y-%m-%d') = #{date}</if>		
        order by etl_date
	</select>
</mapper>