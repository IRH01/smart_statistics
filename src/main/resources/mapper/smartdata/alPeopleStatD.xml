<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="alPeopleStatD">
    <resultMap type="AlPeopleStatD" id="AlPeopleStatDMap" extends="alPeopleStat.AlPeopleStatMap">
    </resultMap>

    <select id="find" resultMap="AlPeopleStatDMap" parameterType="map">
        select
        etl_date,
        pv_cnt,
        uv_cnt,
        stay_cnt
        from tbl_dm_alpeople_stat_d
        where 1=1
        <if test="domainId != null">and domain_id = #{domainId}</if>
        <if test="channelId != null">and channel_id = #{channelId}</if>
        <if test="gameId != null">and game_id = #{gameId}</if>
        <if test="startDate != null and endDate != null">and date_format(etl_date,'%Y-%m-%d') between #{startDate} and
            #{endDate}
        </if>
        order by etl_date
    </select>
</mapper>