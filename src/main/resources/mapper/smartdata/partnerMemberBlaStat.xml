<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="partnerMemberBlaStat">
    <resultMap type="PartnerMemberBlaStat" id="PartnerMemberBlaStatMap">
        <result property="monthId" column="month_id"/>
        <result property="partnerUserId" column="partner_user_id"/>
        <result property="partnerNo" column="partner_no"/>
        <result property="qualMemberMonUCnt" column="qual_member_mon_ucnt"/>
        <result property="qualMemberTotalUCnt" column="qual_member_total_ucnt"/>
        <result property="subAgentUCnt" column="sub_agent_ucnt"/>
        <result property="memberAmount" column="member_amount"/>
        <result property="agentAmount" column="agent_amount"/>
    </resultMap>

    <select id="find" resultMap="PartnerMemberBlaStatMap" parameterType="map">
        select
        month_id,
        partner_user_id,
        partner_no,
        qual_member_mon_ucnt,
        qual_member_total_ucnt,
        sub_agent_ucnt,
        member_amount,
        agent_amount
        from tbl_dm_partner_member_bla_stat
        where 1=1
        <if test="partnerUserId != null and partnerUserId != ''">and partner_user_id like '%'||#{partnerUserId}||'%'
        </if>
        <if test="monthStart != null and monthStart != ''">and date_format(month_id,'%Y-%m') &gt;= #{monthStart}</if>
        <if test="monthEnd != null and monthEnd != ''">and date_format(month_id,'%Y-%m') &lt;= #{monthEnd}</if>
        order by month_id desc
    </select>

    <select id="count" resultType="int" parameterType="map">
        select
        count(*) count
        from tbl_dm_partner_member_bla_stat
        where 1=1
        <if test="partnerUserId != null and partnerUserId != ''">and partner_user_id like '%'||#{partnerUserId}||'%'
        </if>
        <if test="monthStart != null and monthStart != ''">and date_format(month_id,'%Y-%m') &gt;= #{monthStart}</if>
        <if test="monthEnd != null and monthEnd != ''">and date_format(month_id,'%Y-%m') &lt;= #{monthEnd}</if>
    </select>
</mapper>