<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="dataReportPlatformRealtime">
	<resultMap type="DataReportPlatformRealtime" id="DataReportPlatformRealtimeMap"  extends="lossDaily.LossDailyMap">
		<result property="statDate" column="stat_date"/>
		<result property="platformTerminal" column="platform_terminal"/>
		<result property="gameRechargeAmount" column="game_recharge_amount"/>
		<result property="lybRechargeAmount" column="lyb_recharge_amount"/>
		<result property="rebackRechargeAmount" column="reback_recharge_amount"/>
		<result property="totalRechargeAmount" column="total_recharge_amount"/>
		<result property="rechargeUcnt" column="recharge_ucnt"/>
		<result property="rechargeCnt" column="recharge_cnt"/>
		<result property="gameDau" column="game_dau"/>
		<result property="regUcnt" column="reg_ucnt"/>
		<result property="platformDau" column="platform_dau"/>
		<result property="platformSyPv" column="platform_sy_pv"/>
		<result property="platformSyIpCnt" column="platform_sy_ip_cnt"/>
		<result property="createDate" column="create_date"/>
		<result property="updateDate" column="update_date"/>
	</resultMap>
	
	<select id="find" resultMap="DataReportPlatformRealtimeMap" parameterType="map">
		select stat_date, 
		case when platform_terminal = 1 then 'PC' when platform_terminal = 2 then '安卓' when platform_terminal = 3 then 'ios' 
		when platform_terminal = 4 then 'h5' when platform_terminal = 5 then '其他' as platform_terminal, 
		FORMAT(game_recharge_amount,2) as game_recharge_amount, 
		FORMAT(lyb_recharge_amount,2) as lyb_recharge_amount, 
		FORMAT(reback_recharge_amount,2) as reback_recharge_amount, 
		FORMAT(total_recharge_amount,2) as total_recharge_amount, 
		recharge_ucnt, 
		recharge_cnt, 
		game_dau, 
		reg_ucnt, 
		platform_dau, 
		platform_sy_pv, 
		platform_sy_ip_cnt, 
		date_format(create_date,'%Y-%m-%d %H:%i:%s') as create_date, 
		date_format(update_date,'%Y-%m-%d %H:%i:%s') as update_date 
		from 
		tbl_gp_platform_reatime_report
		where
		date_format(stat_date,'%Y-%m-%d') = date_format(sysdate,'%Y-%m-%d')
	</select>
</mapper>